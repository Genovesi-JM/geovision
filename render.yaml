databases:
  - name: geovision-db
    plan: free
    databaseName: geovision
    user: geovision

services:
  - type: web
    name: geovision-backend
    runtime: python
    rootDir: backend
    plan: free
    autoDeploy: true
    buildCommand: python -m pip install --upgrade pip && python -m pip install -r requirements.deploy.txt
    startCommand: python start.py
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.9
      - key: ENV
        value: prod
      - key: CORS_ORIGINS
        value: https://genovesi-jm.github.io,https://geovision.digital,https://www.geovision.digital
      - key: DATABASE_URL
        fromDatabase:
          name: geovision-db
          property: connectionString
      # Set these in Render dashboard as Secret values:
      # - SECRET_KEY
      # - FRONTEND_BASE (e.g. https://genovesi-jm.github.io/geovision)
      # - BACKEND_BASE (e.g. https://geovision-backend.onrender.com)
      # - GOOGLE_CLIENT_ID / GOOGLE_CLIENT_SECRET (optional)
      # - OPENAI_API_KEY (optional)
